{"eta_index_table":"[{\"id\":\"var_templatejgmgopco\",\"name\":\"file\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"D:/Lidar LF/Data thermal/240524/correlation_delayed_thermal_setup_laser_420_240523.timeres\"},{\"id\":\"var_templatejkim8l39\",\"name\":\"binsize\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"16\"},{\"id\":\"var_templatejkim8rzm\",\"name\":\"expname\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"10 m delay\"},{\"id\":\"var_templatejkim8w21\",\"name\":\"bins\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"10000\"},{\"id\":\"var_templatek8g3kag4\",\"name\":\"delay\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"0\"},{\"id\":\"var_templatek8g498fo\",\"name\":\"bw_delay\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"0\"},{\"id\":\"var_templatek8g49hcs\",\"name\":\"fw_delay\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"0\"},{\"id\":\"dpp_templatek7r3sgz1\",\"name\":\"display\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"\"},{\"id\":\"dpp_templatek0e4ffxo\",\"name\":\"save txt\",\"group\":\"swabian\",\"info\":\"\",\"config\":\"\"},{\"id\":\"vi_templatek6z7s4mo\",\"name\":\"quTAG\",\"group\":\"swabian\",\"info\":\"游닆[0, 1, 2, 3, 4, 5] \",\"config\":\"\"},{\"id\":\"vi_templatek0e3sowi\",\"name\":\"forward correlation 23\",\"group\":\"swabian\",\"info\":\"游닌[2, 3] \",\"config\":\"\"},{\"id\":\"vi_templatek0e3qybt\",\"name\":\"backward correlation 23\",\"group\":\"swabian\",\"info\":\"游닌[3, 2] \",\"config\":\"\"},{\"id\":\"vi_templatelxd93jmd\",\"name\":\"forward correlation 24\",\"group\":\"swabian\",\"info\":\"游닌[2, 4] \",\"config\":\"\"},{\"id\":\"vi_templatelxd93sb8\",\"name\":\"backward correlation 24\",\"group\":\"swabian\",\"info\":\"游닌[4, 2] \",\"config\":\"\"},{\"id\":\"vi_templatelxd99cif\",\"name\":\"forward correlation 34\",\"group\":\"swabian\",\"info\":\"游닌[3, 4] \",\"config\":\"\"},{\"id\":\"vi_templatelxd98fhj\",\"name\":\"backward correlation 34\",\"group\":\"swabian\",\"info\":\"游닌[4, 3] \",\"config\":\"\"}]","var_templatejgmgopco":null,"var_templatejkim8l39":null,"var_templatejkim8rzm":null,"var_templatejkim8w21":null,"vi_templatek0e3qybt":"{\"nodes\":[{\"x\":266,\"y\":260,\"fixed\":true,\"text\":\"start\",\"px\":266,\"py\":260},{\"x\":75,\"y\":86,\"fixed\":true,\"text\":\"stop\",\"px\":75,\"py\":86,\"initial\":true}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"3\"},{\"source\":1,\"target\":0,\"text\":\"2\"},{\"source\":0,\"target\":0,\"text\":\"2\"},{\"source\":1,\"target\":1,\"text\":\"3\"}],\"usercode\":\"HISTOGRAM(h32,(`bins`,`binsize`))\\nCLOCK(c2,100,1)\\nstart:\\n    c2.start()\\nstop:\\n    c2.stop()\\n    h32.record_all(c2)\"}","vi_templatek0e3sowi":"{\"nodes\":[{\"x\":258,\"y\":225,\"fixed\":true,\"text\":\"start\",\"px\":258,\"py\":225},{\"x\":76,\"y\":88,\"fixed\":true,\"text\":\"stop\",\"px\":76,\"py\":88,\"initial\":true}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"2\"},{\"source\":1,\"target\":0,\"text\":\"3\"},{\"source\":0,\"target\":0,\"text\":\"3\"},{\"source\":1,\"target\":1,\"text\":\"2\"}],\"usercode\":\"HISTOGRAM(h23,(`bins`,`binsize`))\\nCLOCK(c1,100,1)\\nstart:\\n    c1.start()\\nstop:\\n    c1.stop()\\n    h23.record_all(c1)\"}","dpp_templatek0e4ffxo":"#------IMPORTS-----\r\nfrom pathlib import Path\r\nimport numpy as np\r\n\r\ndef get_files(extensions):\r\n    global path\r\n    all_files = []\r\n    for ext in extensions:\r\n        all_files.extend(path.glob(ext))\r\n    return all_files\r\n    \r\ndef info(filename, binsize=binsize, bins=bins):\r\n    return ('Created with ETA - https://timetag.github.io\\n'+'filename: {}\\n'.format(filename.name) +'binsize: {}\\n'.format(binsize) +'bins: {}\\n'.format(bins) +'mode: {}\\n'.format(HH400_mode if \"HH400_mode\" in globals() else \"qutag\") )\r\n\r\n\r\n\r\n#------ADJUST DELAY-----\r\ndelay = int(float(delay))\r\neta.recipe.set_parameter(\"bw_delay\",str(max(0,-1*delay)))\r\neta.recipe.set_parameter(\"fw_delay\",str(max(0,delay)))\r\neta.load_recipe()\r\n\r\n#------ETA PROCESSING-----\r\nbinsize=int(float(binsize))\r\npath = Path(file)\r\ndatafolder='analyzed data'\r\n\r\nselector = (f for f in get_files(('*.ptu','*.timeres'))) if path.is_dir() else [path]\r\n\r\nfor f in selector:\r\n        cutfile = eta.clips(f)\r\n        result=eta.run({\"timetagger1\":cutfile}, group='quTAG')\r\n        hist1=result[\"h3\"]\r\n        hist2=result[\"h4\"]\r\n        hist0=result[\"h4_zero\"]\r\n        hist1[0]+=hist0[0]\r\n        hist0[0]=0\r\n        fullhist=np.concatenate((hist2[::-1],hist1))\r\n        f.parent.joinpath(datafolder).mkdir(parents=True, exist_ok=True)\r\n        np.savetxt(f.parent.joinpath(datafolder, f.stem + '_correlation' +  '.txt'), np.transpose([np.arange(-hist2.size,hist1.size,dtype=np.float32)*binsize,fullhist]), delimiter='\\t', header=info(f))\r\n        eta.send(str(f.name) + ' has been successfully processed')\r\neta.send('FINISHED')\r\n\r\n","vi_templatek6z7s4mo":"{\"nodes\":[{\"x\":192,\"y\":157,\"fixed\":true,\"initial\":true}],\"edges\":[],\"usercode\":\"\\n########## click Help on the menu to get started! ##########\\nRFILE(timetagger1,[0,1,2,3,4,5])\"}","dpp_templatek7r3sgz1":"# Unfortunately no realtime recipe for quTAG, as the file is not written by\n# the control software until the experiment is stopped.\n#------IMPORTS-----\n\nimport numpy as np\nimport pandas as pd\nfrom pathlib import Path\n\nimport etabackend.tk.plot as etaplt\nimport etabackend.tk.utils as etautils\n\n#------ADJUST DELAY-----\ndelay = int(float(delay))\neta.recipe.set_parameter(\"bw_delay\",str(max(0,-1*delay)))\neta.recipe.set_parameter(\"fw_delay\",str(max(0,delay)))\neta.load_recipe()\n\n#------ETA PROCESSING-----\ncut=eta.clips(Path(file), format = 1)\nresult= eta.run({\"timetagger1\":cut}, group='quTAG')\nhist1=result[\"h3\"]\nhist2=result[\"h4\"]\nhist0=result[\"h4_zero\"]\nhist1[0]+= hist0[0]\n\nfullhist=np.concatenate((hist2[::-1],hist1))\nxdata = np.arange(-hist2.size,hist1.size,dtype=np.float32)*int(float(binsize))\n\nf=Path(file)\nDATAFOLDER = 'analyzed data'\nLABEL = expname\n#------PLOTTING-----\n\ndf = pd.DataFrame(np.vstack((xdata, fullhist)).T, \n                  columns=['time bins', 'histogram events'])\ndf['log events'] = np.clip(df['histogram events'].values, 0.5, None)\n\ndef generate_doc(doc):\n    root = etaplt.plot_histogram(df, f,  f.parent.joinpath(DATAFOLDER), \n                                 data_name=LABEL.capitalize(), file_label=LABEL.lower(), \n                                 info=etautils.info(globals_dict=eta.compilecache_vars['quTAG'], recipe_type=LABEL))\n    doc.add_root(root)\n    return doc\n\neta.display(generate_doc, 'bokeh')\n","var_templatek8g3kag4":null,"var_templatek8g498fo":null,"var_templatek8g49hcs":null,"vi_templatelxd93jmd":"{\"nodes\":[{\"x\":346,\"y\":111,\"fixed\":true,\"text\":\"start\",\"px\":346,\"py\":111},{\"x\":76,\"y\":88,\"fixed\":true,\"text\":\"stop\",\"px\":76,\"py\":88,\"initial\":true}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"2\"},{\"source\":1,\"target\":0,\"text\":\"4\"},{\"source\":0,\"target\":0,\"text\":\"4\"},{\"source\":1,\"target\":1,\"text\":\"2\"}],\"usercode\":\"HISTOGRAM(h24,(`bins`,`binsize`))\\nCLOCK(c3,100,1)\\nstart:\\n    c3.start()\\nstop:\\n    c3.stop()\\n    h24.record_all(c3)\"}","vi_templatelxd93sb8":"{\"nodes\":[{\"x\":346,\"y\":111,\"fixed\":true,\"text\":\"start\",\"px\":346,\"py\":111},{\"x\":76,\"y\":88,\"fixed\":true,\"text\":\"stop\",\"px\":76,\"py\":88,\"initial\":true}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"4\"},{\"source\":1,\"target\":0,\"text\":\"2\"},{\"source\":0,\"target\":0,\"text\":\"2\"},{\"source\":1,\"target\":1,\"text\":\"4\"}],\"usercode\":\"HISTOGRAM(h42,(`bins`,`binsize`))\\nCLOCK(c4,100,1)\\nstart:\\n    c4.start()\\nstop:\\n    c4.stop()\\n    h42.record_all(c4)\"}","vi_templatelxd98fhj":"{\"nodes\":[{\"x\":346,\"y\":111,\"fixed\":true,\"text\":\"start\",\"px\":346,\"py\":111},{\"x\":76,\"y\":88,\"fixed\":true,\"text\":\"stop\",\"px\":76,\"py\":88,\"initial\":true}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"4\"},{\"source\":1,\"target\":0,\"text\":\"3\"},{\"source\":0,\"target\":0,\"text\":\"3\"},{\"source\":1,\"target\":1,\"text\":\"4\"}],\"usercode\":\"HISTOGRAM(h43,(`bins`,`binsize`))\\nCLOCK(c6,100,1)\\nstart:\\n    c6.start()\\nstop:\\n    c6.stop()\\n    h43.record_all(c6)\"}","vi_templatelxd99cif":"{\"nodes\":[{\"x\":346,\"y\":111,\"fixed\":true,\"text\":\"start\",\"px\":346,\"py\":111},{\"x\":76,\"y\":88,\"fixed\":true,\"text\":\"stop\",\"px\":76,\"py\":88,\"initial\":true}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"3\"},{\"source\":1,\"target\":0,\"text\":\"4\"},{\"source\":0,\"target\":0,\"text\":\"4\"},{\"source\":1,\"target\":1,\"text\":\"3\"}],\"usercode\":\"HISTOGRAM(h34,(`bins`,`binsize`))\\nCLOCK(c5,100,1)\\nstart:\\n    c5.start()\\nstop:\\n    c5.stop()\\n    h34.record_all(c5)\"}"}